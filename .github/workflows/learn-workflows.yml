name: Learning Github Actions

on: 
  workflow_dispatch:
    inputs:
      Environment:
        required: true

jobs:
  build:
    runs-on: windows-latest
    steps:
    - name: Build project
      run: echo "Compiling..."
  prepare-artifacts:
    needs: build
    runs-on: windows-latest
    steps:
    - name: Prepare artifacts
      run: echo "Zipping..."
  build-matrix:
    needs: prepare-artifacts
    runs-on: windows-latest
    steps:
      - id: set-matrix
        run: echo '::set-output name=environments_arr::${{ github.event.inputs.Environment }}'
    outputs:
      environments_arr: ${{ steps.set-matrix.outputs.environments_arr }}
  deployment:
    needs: build-matrix
    strategy:
      matrix: 
        environ: ${{ fromJson(needs.build-matrix.outputs.environments_arr) }}
    runs-on: windows-latest
  
    steps: 
    - name: Unzipping artifacts
      run: echo "Extracting files..."
    - name: Single line script
      run: echo "Running ${{ github.job }} in ${{ matrix.environ }}"
